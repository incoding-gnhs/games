<!DOCTYPE html> <html lang="ko"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> <title>턴제 배틀 게임</title> <style> * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; } body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); min-height: 100vh; color: white; overflow-x: hidden; touch-action: manipulation; } .container { max-width: 800px; margin: 0 auto; padding: 20px; } h1 { text-align: center; font-size: 2rem; margin-bottom: 30px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); } /* 직업 선택 화면 */ .job-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; } .job-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 12px; padding: 20px; color: white; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.3); touch-action: manipulation; } .job-card:active { transform: scale(0.95); } .job-card:hover { transform: translateY(-5px); box-shadow: 0 8px 12px rgba(0,0,0,0.4); } .job-icon { width: 50px; height: 50px; margin: 0 auto 10px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; } .job-name { font-size: 1.2rem; font-weight: bold; margin-bottom: 10px; text-align: center; } .job-stats { font-size: 0.85rem; line-height: 1.6; } .job-skill { color: #ffd700; font-weight: bold; margin-top: 5px; } /* 배틀 화면 */ .battle-area { display: none; } .battle-area.active { display: block; } .characters { display: grid; grid-template-columns: 1fr; gap: 20px; margin-bottom: 30px; } .character-card { border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); } .player-card { background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: 3px solid #34d399; } .enemy-card { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); border: 3px solid #f87171; } .character-header { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; font-size: 1.3rem; font-weight: bold; } .stat-bar { margin-bottom: 12px; } .stat-label { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem; } .stat-bar-bg { width: 100%; height: 12px; background: rgba(0,0,0,0.3); border-radius: 6px; overflow: hidden; } .stat-bar-fill { height: 100%; transition: width 0.3s ease; border-radius: 6px; } .hp-bar { background: #ef4444; } .np-bar { background: #3b82f6; } .character-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.85rem; margin-top: 10px; } /* 액션 버튼 */ .action-buttons { display: flex; flex-direction: column; gap: 15px; margin-bottom: 30px; } .action-btn { padding: 18px; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: bold; color: white; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.3); touch-action: manipulation; } .action-btn:active { transform: scale(0.95); } .attack-btn { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); } .attack-btn:hover:not(:disabled) { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); } .skill-btn { background: linear-gradient(135deg, #a855f7 0%, #9333ea 100%); } .skill-btn:hover:not(:disabled) { background: linear-gradient(135deg, #9333ea 0%, #7e22ce 100%); } .action-btn:disabled { background: #4b5563; color: #9ca3af; cursor: not-allowed; opacity: 0.6; } /* 전투 로그 */ .battle-log { background: rgba(0,0,0,0.7); border-radius: 12px; padding: 20px; max-height: 250px; overflow-y: auto; margin-bottom: 20px; } .battle-log h3 { font-size: 1.2rem; margin-bottom: 15px; } .log-entry { color: #e5e7eb; margin-bottom: 8px; line-height: 1.5; font-size: 0.95rem; } /* 게임 종료 */ .game-over { text-align: center; margin-top: 20px; } .restart-btn { padding: 18px 40px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: none; border-radius: 12px; color: white; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.3); touch-action: manipulation; } .restart-btn:active { transform: scale(0.95); } .turn-indicator { text-align: center; font-size: 1.1rem; margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; } @media (min-width: 640px) { .job-grid { grid-template-columns: repeat(3, 1fr); } .action-buttons { flex-direction: row; } } </style> </head> <body> <div class="container"> <h1 id="title">직업을 선택하세요</h1> <!-- 직업 선택 화면 --> <div id="jobSelect" class="job-grid"></div> <!-- 배틀 화면 --> <div id="battleArea" class="battle-area"> <div class="turn-indicator" id="turnIndicator"></div> <div class="characters"> <div class="character-card player-card"> <div class="character-header"> <span>👤</span> <span id="playerName">플레이어</span> </div> <div class="stat-bar"> <div class="stat-label"> <span>❤️ HP</span> <span id="playerHpText">0/0</span> </div> <div class="stat-bar-bg"> <div class="stat-bar-fill hp-bar" id="playerHpBar"></div> </div> </div> <div class="stat-bar"> <div class="stat-label"> <span>⚡ NP</span> <span id="playerNpText">0/0</span> </div> <div class="stat-bar-bg"> <div class="stat-bar-fill np-bar" id="playerNpBar"></div> </div> </div> <div class="character-stats"> <div>⚔️ 공격: <span id="playerAtk">0</span></div> <div>🛡️ 방어: <span id="playerDef">0</span></div> </div> </div> <div class="character-card enemy-card"> <div class="character-header"> <span>👹</span> <span id="enemyName">적</span> </div> <div class="stat-bar"> <div class="stat-label"> <span>❤️ HP</span> <span id="enemyHpText">0/0</span> </div> <div class="stat-bar-bg"> <div class="stat-bar-fill hp-bar" id="enemyHpBar"></div> </div> </div> <div class="stat-bar"> <div class="stat-label"> <span>⚡ NP</span> <span id="enemyNpText">0/0</span> </div> <div class="stat-bar-bg"> <div class="stat-bar-fill np-bar" id="enemyNpBar"></div> </div> </div> <div class="character-stats"> <div>⚔️ 공격: <span id="enemyAtk">0</span></div> <div>🛡️ 방어: <span id="enemyDef">0</span></div> </div> </div> </div> <div class="action-buttons"> <button class="action-btn attack-btn" id="attackBtn">일반 공격</button> <button class="action-btn skill-btn" id="skillBtn">스킬</button> </div> <div class="battle-log"> <h3>전투 로그</h3> <div id="logContainer"></div> </div> <div class="game-over" id="gameOver" style="display: none;"> <button class="restart-btn" id="restartBtn">다시 시작</button> </div> </div> </div> 


<script>
  const JOBS = {
    마법사: { hp: 80, np: 150, attack: 35, defense: 5, skill: '파이어볼', skillCost: 30, skillDmg: 60 },
    검사: { hp: 120, np: 80, attack: 45, defense: 15, skill: '연속베기', skillCost: 25, skillDmg: 70 },
    성기사: { hp: 150, np: 100, attack: 35, defense: 25, skill: '신성한빛', skillCost: 35, skillDmg: 50 },
    물리학자: { hp: 90, np: 120, attack: 40, defense: 10, skill: '양자붕괴', skillCost: 40, skillDmg: 80 },
    농부: { hp: 110, np: 60, attack: 30, defense: 20, skill: '낫질', skillCost: 20, skillDmg: 45 },
    졸병: { hp: 100, np: 70, attack: 35, defense: 15, skill: '돌진', skillCost: 25, skillDmg: 55 },
    거지: { hp: 70, np: 50, attack: 25, defense: 5, skill: '구걸', skillCost: 15, skillDmg: 30 },
    상인: { hp: 85, np: 90, attack: 30, defense: 10, skill: '금화투척', skillCost: 20, skillDmg: 50 },
    힐러: { hp: 95, np: 130, attack: 20, defense: 8, skill: '치유의손길', skillCost: 25, skillDmg: -40 },
    도적: { hp: 75, np: 100, attack: 50, defense: 8, skill: '암습', skillCost: 30, skillDmg: 75 }
  };

  const ATTACK_EFFECTS = [
    { type: 'miss', name: '빗나감!', multiplier: 0, chance: 0.1 },
    { type: 'critical', name: '급소 적중!', multiplier: 2, chance: 0.15 },
    { type: 'dodge', name: '회피당함!', multiplier: 0, chance: 0.1 },
    { type: 'self', name: '자신을 공격!', multiplier: -0.5, chance: 0.05 },
    { type: 'normal', name: '명중!', multiplier: 1, chance: 0.6 }
  ];

  // ✅ 연승 카운터 추가
  let winStreak = 0;

  let gameState = {
    phase: 'select',
    player: null,
    enemy: null,
    turn: 'player',
    log: [],
    winner: null
  };

  // 직업 선택 화면 렌더링
  function renderJobSelect() {
    const container = document.getElementById('jobSelect');
    container.innerHTML = '';
    
    Object.keys(JOBS).forEach(jobName => {
      const job = JOBS[jobName];
      const card = document.createElement('button');
      card.className = 'job-card';
      card.innerHTML = `
        <div class="job-icon">👤</div>
        <div class="job-name">${jobName}</div>
        <div class="job-stats">
          HP: ${job.hp}<br>
          NP: ${job.np}<br>
          공격: ${job.attack}<br>
          <div class="job-skill">${job.skill}</div>
        </div>
      `;
      card.addEventListener('click', () => selectJob(jobName));
      container.appendChild(card);
    });
  }

  // 직업 선택
  function selectJob(jobName) {
    const playerData = {
      job: jobName,
      ...JOBS[jobName],
      maxHp: JOBS[jobName].hp,
      maxNp: JOBS[jobName].np,
      currentHp: JOBS[jobName].hp,
      currentNp: JOBS[jobName].np
    };

    const jobList = Object.keys(JOBS);
    const randomJob = jobList[Math.floor(Math.random() * jobList.length)];
    const enemyData = {
      job: randomJob,
      ...JOBS[randomJob],
      maxHp: JOBS[randomJob].hp,
      maxNp: JOBS[randomJob].np,
      currentHp: JOBS[randomJob].hp,
      currentNp: JOBS[randomJob].np
    };

    gameState.player = playerData;
    gameState.enemy = enemyData;
    gameState.phase = 'battle';
    gameState.log = [
      `플레이어는 ${jobName}을(를) 선택했다!`,
      `적 ${randomJob}이(가) 나타났다!`
    ];

    document.getElementById('jobSelect').style.display = 'none';
    document.getElementById('battleArea').classList.add('active');
    document.getElementById('title').textContent = '턴제 배틀';
    
    updateBattleUI();
  }

  // 공격 효과 계산
  function getAttackEffect() {
    const random = Math.random();
    let cumulative = 0;
    
    for (const effect of ATTACK_EFFECTS) {
      cumulative += effect.chance;
      if (random <= cumulative) {
        return effect;
      }
    }
    return ATTACK_EFFECTS[4];
  }

  // 공격 처리
  function attack(attacker, defender, isSkill = false) {
    if (isSkill && attacker.currentNp < attacker.skillCost) {
      return { success: false, message: 'NP가 부족합니다!' };
    }

    const effect = getAttackEffect();
    let damage = isSkill ? attacker.skillDmg : attacker.attack;
    
    if (effect.type === 'self') {
      damage = Math.max(0, Math.floor(attacker.attack * Math.abs(effect.multiplier)));
      const newHp = Math.max(0, attacker.currentHp - damage);
      return {
        success: true,
        effect: effect.name,
        damage,
        newHp,
        isSelf: true,
        npCost: isSkill ? attacker.skillCost : 0
      };
    }

    if (isSkill && attacker.skill === '치유의손길') {
      const heal = Math.abs(damage);
      const newHp = Math.min(attacker.maxHp, attacker.currentHp + heal);
      return {
        success: true,
        effect: '치유 성공!',
        damage: heal,
        newHp,
        isHeal: true,
        npCost: attacker.skillCost
      };
    }

    if (effect.multiplier === 0) {
      return {
        success: true,
        effect: effect.name,
        damage: 0,
        newHp: defender.currentHp,
        npCost: isSkill ? attacker.skillCost : 0
      };
    }

    damage = Math.floor(damage * effect.multiplier);
    damage = Math.max(0, damage - defender.defense);
    const newHp = Math.max(0, defender.currentHp - damage);

    return {
      success: true,
      effect: effect.name,
      damage,
      newHp,
      npCost: isSkill ? attacker.skillCost : 0
    };
  }

  // 플레이어 공격
  function playerAttack(isSkill = false) {
    if (gameState.turn !== 'player' || gameState.phase !== 'battle') return;

    const result = attack(gameState.player, gameState.enemy, isSkill);
    
    if (!result.success) {
      addLog(result.message);
      return;
    }

    gameState.player.currentNp -= result.npCost;
    
    if (result.isSelf) {
      gameState.player.currentHp = result.newHp;
    } else if (result.isHeal) {
      gameState.player.currentHp = result.newHp;
    } else {
      gameState.enemy.currentHp = result.newHp;
    }

    let message = isSkill 
      ? `플레이어가 ${gameState.player.skill}을(를) 사용! ${result.effect}` 
      : `플레이어의 공격! ${result.effect}`;

    if (result.isHeal) {
      message += ` HP ${result.damage} 회복!`;
    } else if (result.isSelf) {
      message += ` 자신에게 ${result.damage} 데미지!`;
    } else {
      message += ` ${result.damage} 데미지!`;
    }

    addLog(message);
    updateBattleUI();

    if (gameState.player.currentHp <= 0) {
      endGame('enemy');
    } else if (gameState.enemy.currentHp <= 0) {
      endGame('player');
    } else {
      gameState.turn = 'enemy';
      updateBattleUI();
      setTimeout(enemyTurn, 1500);
    }
  }

  // 적 턴
  function enemyTurn() {
    const useSkill = gameState.enemy.currentNp >= gameState.enemy.skillCost && Math.random() > 0.5;
    const result = attack(gameState.enemy, gameState.player, useSkill);

    gameState.enemy.currentNp -= result.npCost;
    
    if (result.isSelf) {
      gameState.enemy.currentHp = result.newHp;
    } else if (result.isHeal) {
      gameState.enemy.currentHp = result.newHp;
    } else {
      gameState.player.currentHp = result.newHp;
    }

    let message = useSkill 
      ? `적이 ${gameState.enemy.skill}을(를) 사용! ${result.effect}` 
      : `적의 공격! ${result.effect}`;

    if (result.isHeal) {
      message += ` HP ${result.damage} 회복!`;
    } else if (result.isSelf) {
      message += ` 자신에게 ${result.damage} 데미지!`;
    } else {
      message += ` ${result.damage} 데미지!`;
    }

    addLog(message);
    updateBattleUI();

    if (gameState.player.currentHp <= 0) {
      endGame('enemy');
    } else if (gameState.enemy.currentHp <= 0) {
      endGame('player');
    } else {
      gameState.turn = 'player';
      updateBattleUI();
    }
  }

  // ✅ 게임 종료 (연승 카운터 포함)
  function endGame(winner) {
    gameState.phase = 'end';
    gameState.winner = winner;
    
    if (winner === 'player') {
      winStreak++;
      addLog(`플레이어가 승리했습니다! 🎉 (현재 ${winStreak}연승)`);
    } else {
      addLog(`플레이어가 패배했습니다... 😢`);
      addLog(`이번 전적: ${winStreak}연승 후 패배`);
      winStreak = 0;
    }
    
    updateBattleUI();
    document.getElementById('gameOver').style.display = 'block';
  }

  // 로그 추가
  function addLog(message) {
    gameState.log.push(message);
    const container = document.getElementById('logContainer');
    const entry = document.createElement('div');
    entry.className = 'log-entry';
    entry.textContent = message;
    container.appendChild(entry);
    container.scrollTop = container.scrollHeight;
  }

  // UI 업데이트
  function updateBattleUI() {
    const { player, enemy, turn, phase } = gameState;

    document.getElementById('playerName').textContent = `플레이어 - ${player.job}`;
    document.getElementById('playerHpText').textContent = `${player.currentHp}/${player.maxHp}`;
    document.getElementById('playerNpText').textContent = `${player.currentNp}/${player.maxNp}`;
    document.getElementById('playerHpBar').style.width = `${(player.currentHp / player.maxHp) * 100}%`;
    document.getElementById('playerNpBar').style.width = `${(player.currentNp / player.maxNp) * 100}%`;
    document.getElementById('playerAtk').textContent = player.attack;
    document.getElementById('playerDef').textContent = player.defense;

    document.getElementById('enemyName').textContent = `적 - ${enemy.job}`;
    document.getElementById('enemyHpText').textContent = `${enemy.currentHp}/${enemy.maxHp}`;
    document.getElementById('enemyNpText').textContent = `${enemy.currentNp}/${enemy.maxNp}`;
    document.getElementById('enemyHpBar').style.width = `${(enemy.currentHp / enemy.maxHp) * 100}%`;
    document.getElementById('enemyNpBar').style.width = `${(enemy.currentNp / enemy.maxNp) * 100}%`;
    document.getElementById('enemyAtk').textContent = enemy.attack;
    document.getElementById('enemyDef').textContent = enemy.defense;

    const turnText = turn === 'player' ? '플레이어 턴' : '적 턴';
    document.getElementById('turnIndicator').textContent = turnText;

    const attackBtn = document.getElementById('attackBtn');
    const skillBtn = document.getElementById('skillBtn');
    
    if (phase === 'battle' && turn === 'player') {
      attackBtn.disabled = false;
      skillBtn.disabled = player.currentNp < player.skillCost;
      skillBtn.textContent = `${player.skill} (NP ${player.skillCost})`;
    } else {
      attackBtn.disabled = true;
      skillBtn.disabled = true;
    }
  }

  // ✅ 게임 리셋 (연승은 유지)
  function resetGame() {
    gameState = {
      phase: 'select',
      player: null,
      enemy: null,
      turn: 'player',
      log: [],
      winner: null
    };

    document.getElementById('jobSelect').style.display = 'grid';
    document.getElementById('battleArea').classList.remove('active');
    document.getElementById('gameOver').style.display = 'none';
    document.getElementById('title').textContent = '직업을 선택하세요';
    document.getElementById('logContainer').innerHTML = '';
  }

  document.getElementById('attackBtn').addEventListener('click', () => playerAttack(false));
  document.getElementById('skillBtn').addEventListener('click', () => playerAttack(true));
  document.getElementById('restartBtn').addEventListener('click', resetGame);

  renderJobSelect();
</script>


 </body> </html>