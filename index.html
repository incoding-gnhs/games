<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²Œì„ ëª©ë¡</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }

        .games-grid {
            display: none;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .game-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-color: #007bff;
        }

        .game-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .game-id {
            font-size: 0.9rem;
            color: #666;
            background: #f8f9fa;
            padding: 5px 10px;
            border-radius: 15px;
            display: inline-block;
        }

        .mobile-message {
            display: none;
            text-align: center;
            color: #333;
            font-size: 1.2rem;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        /* ê°€ë¡œ í™”ë©´ì¼ ë•Œë§Œ ê²Œì„ ëª©ë¡ í‘œì‹œ */
        @media (orientation: landscape) and (min-width: 768px) {
            .games-grid {
                display: grid;
            }
            .mobile-message {
                display: none;
            }
        }

        /* ì„¸ë¡œ í™”ë©´ì´ê±°ë‚˜ ì‘ì€ í™”ë©´ì¼ ë•Œ ë©”ì‹œì§€ í‘œì‹œ */
        @media (orientation: portrait), (max-width: 767px) {
            .games-grid {
                display: none;
            }
            .mobile-message {
                display: block;
            }
        }

        .loading {
            text-align: center;
            color: #666;
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® ê²Œì„ ëª©ë¡</h1>
        
        <div class="mobile-message">
            <h2>ğŸ“± ëª¨ë°”ì¼ ê²Œì„</h2>
            <div id="mobileGamesGrid" class="games-grid" style="display: grid; margin-top: 20px;">
                <div class="loading">ê²Œì„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>

        <div class="games-grid" id="gamesGrid">
            <div class="loading">ê²Œì„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        </div>
    </div>

    <script>
        // ê²Œì„ íŒŒì¼ ëª©ë¡ (ì„œë²„ì—ì„œ ë™ì ìœ¼ë¡œ ê°€ì ¸ì˜´)
        let desktopGames = [];
        let mobileGames = [];

        // ì„œë²„ì—ì„œ ë°ìŠ¤í¬íƒ‘ ê²Œì„ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        async function fetchDesktopGames() {
            try {
                const response = await fetch('/api/desktop-games');
                if (response.ok) {
                    desktopGames = await response.json();
                    renderGames(); // íŒŒì¼ ëª©ë¡ì„ ê°€ì ¸ì˜¨ í›„ ë Œë”ë§
                } else {
                    console.error('ë°ìŠ¤í¬íƒ‘ ê²Œì„ ëª©ë¡ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    showError('gamesGrid', 'ë°ìŠ¤í¬íƒ‘ ê²Œì„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ì„œë²„ ì—°ê²° ì˜¤ë¥˜:', error);
                showError('gamesGrid', 'ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // ì„œë²„ì—ì„œ ëª¨ë°”ì¼ ê²Œì„ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        async function fetchMobileGames() {
            try {
                const response = await fetch('/api/mobile-games');
                if (response.ok) {
                    mobileGames = await response.json();
                    renderMobileGames(); // íŒŒì¼ ëª©ë¡ì„ ê°€ì ¸ì˜¨ í›„ ë Œë”ë§
                } else {
                    console.error('ëª¨ë°”ì¼ ê²Œì„ ëª©ë¡ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    showError('mobileGamesGrid', 'ëª¨ë°”ì¼ ê²Œì„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ì„œë²„ ì—°ê²° ì˜¤ë¥˜:', error);
                showError('mobileGamesGrid', 'ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
        function showError(gridId, message) {
            const gamesGrid = document.getElementById(gridId);
            gamesGrid.innerHTML = `<div class="loading" style="color: #dc3545;">${message}</div>`;
        }

        // í™”ë©´ ë°©í–¥ê³¼ í¬ê¸° í™•ì¸
        function checkScreenOrientation() {
            const isLandscape = window.innerWidth > window.innerHeight;
            const isWideScreen = window.innerWidth >= 768;
            
            return isLandscape && isWideScreen;
        }

        // ê²Œì„ ì¹´ë“œ ìƒì„± (ë°ìŠ¤í¬íƒ‘)
        function createGameCard(filename) {
            const gameId = filename.replace('.html', '');
            const card = document.createElement('div');
            card.className = 'game-card';
            card.onclick = () => navigateToGame(filename, 'desktop');
            
            card.innerHTML = `
                <div class="game-title">ê²Œì„ ${gameId}</div>
                <div class="game-id">ID: ${gameId}</div>
            `;
            
            return card;
        }

        // ëª¨ë°”ì¼ ê²Œì„ ì¹´ë“œ ìƒì„±
        function createMobileGameCard(filename) {
            const gameId = filename.replace('.html', '');
            const card = document.createElement('div');
            card.className = 'game-card';
            card.onclick = () => navigateToGame(filename, 'mobile');
            
            card.innerHTML = `
                <div class="game-title">ëª¨ë°”ì¼ ê²Œì„ ${gameId}</div>
                <div class="game-id">ID: ${gameId}</div>
            `;
            
            return card;
        }

        // ê²Œì„ìœ¼ë¡œ ì´ë™
        function navigateToGame(filename, type) {
            window.location.href = `/${type}/${filename}`;
        }

        // ë°ìŠ¤í¬íƒ‘ ê²Œì„ ëª©ë¡ ë Œë”ë§
        function renderGames() {
            const gamesGrid = document.getElementById('gamesGrid');
            
            if (checkScreenOrientation()) {
                if (desktopGames.length === 0) {
                    gamesGrid.innerHTML = '<div class="loading">ê²Œì„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
                    return;
                }
                
                gamesGrid.innerHTML = '';
                
                desktopGames.forEach(filename => {
                    const card = createGameCard(filename);
                    gamesGrid.appendChild(card);
                });
            }
        }

        // ëª¨ë°”ì¼ ê²Œì„ ëª©ë¡ ë Œë”ë§
        function renderMobileGames() {
            const mobileGamesGrid = document.getElementById('mobileGamesGrid');
            
            if (mobileGames.length === 0) {
                mobileGamesGrid.innerHTML = '<div class="loading">ëª¨ë°”ì¼ ê²Œì„ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            mobileGamesGrid.innerHTML = '';
            
            mobileGames.forEach(filename => {
                const card = createMobileGameCard(filename);
                mobileGamesGrid.appendChild(card);
            });
        }

        // ì´ˆê¸° ë Œë”ë§
        document.addEventListener('DOMContentLoaded', () => {
            fetchDesktopGames(); // ì„œë²„ì—ì„œ ë°ìŠ¤í¬íƒ‘ ê²Œì„ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
            fetchMobileGames(); // ì„œë²„ì—ì„œ ëª¨ë°”ì¼ ê²Œì„ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        });

        // í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ ë‹¤ì‹œ í™•ì¸
        window.addEventListener('resize', () => {
            renderGames();
            renderMobileGames();
        });
        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                renderGames();
                renderMobileGames();
            }, 100); // ë°©í–¥ ë³€ê²½ í›„ ì•½ê°„ì˜ ì§€ì—°
        });
    </script>
</body>
</html>
